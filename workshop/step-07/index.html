<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Step 7 - Add Terrain - Te Ara Hura Workshop</title>
  <link rel="icon" type="image/x-icon" href="../favicon.ico">
  <link href="https://fonts.googleapis.com/css2?family=Overpass:wght@300;400;600&family=Overpass+Mono:wght@400&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../workshop.css">
</head>
<body>
  <div class="workshop-container">
    <aside class="workshop-sidebar">
      <button class="sidebar-toggle" id="sidebarToggle" aria-label="Toggle sidebar">
        <span class="toggle-icon">‚ò∞</span>
      </button>
      <div class="sidebar-content" id="sidebarContent">
        <div class="sidebar-logo">
          <img src="../images/foss4g2025-logo.svg" alt="FOSS4G 2025" class="logo">
        </div>
        <div class="sidebar-header">
          <h2><a href="../welcome/" class="sidebar-header-link">Standalone Web Maps, No Platform Required</a></h2>
        </div>
        <nav class="sidebar-nav">
          
            
            
              <a href="../step-01/" class="sidebar-item">
            
              <span class="step-number">Step 1</span>
              <span class="step-title">Get Set Up</span>
            </a>
          
            
            
              <a href="../step-02/" class="sidebar-item">
            
              <span class="step-number">Step 2</span>
              <span class="step-title">Use Overpass to Create an OpenStreetMap Extract</span>
            </a>
          
            
            
              <a href="../step-03/" class="sidebar-item">
            
              <span class="step-number">Step 3</span>
              <span class="step-title">Use Maplibre to Render Your Map</span>
            </a>
          
            
            
              <a href="../step-04/" class="sidebar-item">
            
              <span class="step-number">Step 4</span>
              <span class="step-title">Initialize GitHub Pages to Display Your Map</span>
            </a>
          
            
            
              <a href="../step-05/" class="sidebar-item">
            
              <span class="step-number">Step 5</span>
              <span class="step-title">Download Reference Layers from Protomaps</span>
            </a>
          
            
            
              <a href="../step-06/" class="sidebar-item">
            
              <span class="step-number">Step 6</span>
              <span class="step-title">Configure the Stylesheet</span>
            </a>
          
            
            
              <a href="./" class="sidebar-item active">
            
              <span class="step-number">Step 7</span>
              <span class="step-title">Add Terrain (Hillshade, Contours)</span>
            </a>
          
            
            
              <a href="../step-08/" class="sidebar-item">
            
              <span class="step-number">Step 8</span>
              <span class="step-title">Add Interactivity</span>
            </a>
          
          
            <div class="sidebar-divider"></div>
            <div class="sidebar-label">Bonus Steps</div>
            
          
        </nav>
      </div>
    </aside>

    <main class="workshop-main">
      <article class="workshop-content">
        
          <h1>Step 7 - Add Terrain</h1>
        
        
        
        <h2>Creating a Hillshade</h2>
<p>In this step, we'll add terrain to your map by styling custom tiles with a hillshade effect. This will give your map a 3D appearance and help users understand the topography of Waiheke Island.</p>
<h3>Download Terrain Tiles</h3>
<p>We'll download the terrain tiles for the same bounding box we used for Protomaps:</p>
<ol>
<li>
<p><strong>Download Mapterhorn tiles</strong>: Use the PMTiles CLI to extract raster-dem tiles:</p>
<pre><code class="language-bash">pmtiles extract \
--bbox=174.8,-37.0,175.2,-36.7 \
https://download.mapterhorn.com/planet.pmtiles \
sources/waiheke_island_terrain.pmtiles
</code></pre>
<p><strong>Note</strong>: The source for these tiles is <a rel="noreferrer" target="_blank" href="https://protomaps.com/blog/mapterhorn-terrain/">Mapterhorn</a>, a recent effort to update the quality and coverage of global terrain tiles. The work is ongoing, so if you have a business with an interest high resolution terrain data for visualization, please reach out!</p>
</li>
<li>
<p><strong>Wait for download</strong>: This may take several minutes depending on your connection.</p>
</li>
<li>
<p><strong>Verify the file</strong>:</p>
<pre><code class="language-bash">ls -lh sources/waiheke_island_terrain.pmtiles 
</code></pre>
</li>
</ol>
<h3>Update Your Stylesheet</h3>
<p>Now we'll add the terrain layers to your <code>style.json</code>. Follow the instructions for Step 6 to do this through Maputnik, or follow the instructions below to edit the <code>style.json</code> directly.</p>
<ol>
<li>
<p><strong>Add the terrain source</strong> to your <code>sources</code> section in <code>style.json</code>:</p>
<pre><code class="language-json">{
  {
  "version": 8,
  "sources": {
    ... },
    "terrain": {
      "type": "raster-dem",
      "url": "pmtiles://sources/waiheke_island_terrain.pmtiles",
      "tileSize": 256,
      "encoding": "terrarium"
    }
  },
  "layers": [
    // ... existing layers ...
  ]
}
</code></pre>
</li>
<li>
<p><strong>Add the hillshade layer</strong> to your layers list. This should go after the <code>earth</code> layer but <strong>before</strong> the <code>landcover</code> layer so it appears underneath:</p>
<pre><code class="language-json">{
  "id": "hillshade",
  "type": "hillshade",
  "source": "terrain",
  "paint": {
    "hillshade-accent-color": "hsla(0, 0%, 0%, 0.1)",
    "hillshade-exaggeration": 0.5,
    "hillshade-highlight-color": "hsla(0, 0%, 100%, 0.1)",
    "hillshade-illumination-direction": 315,
    "hillshade-shadow-color": "hsla(0, 0%, 0%, 0.5)"
  }
}
</code></pre>
<p>Here is an explanation of these properties:</p>
<ul>
<li><code>hillshade-exaggeration</code>: Controls how dramatic the terrain looks (0.0 to 1.0)</li>
<li><code>hillshade-illumination-direction</code>: Direction of the light source (0-359 degrees)</li>
<li><code>hillshade-accent-color</code>: Color of shadows</li>
<li><code>hillshade-highlight-color</code>: Color of highlights</li>
</ul>
</li>
</ol>
<h3>Test Your Map</h3>
<ol>
<li>
<p><strong>Refresh your browser</strong>: make sure Caddy is still running and go to <code>http://127.0.0.1:1234/index.html</code></p>
</li>
<li>
<p><strong>You should see</strong>:</p>
<ul>
<li>The Protomaps basemap</li>
<li>Terrain showing the topography underneath the landcover</li>
<li>Te Ara Hura displayed on top</li>
</ul>
</li>
</ol>
<h3>Troubleshooting</h3>
<p><strong>Terrain doesn't show?</strong></p>
<ul>
<li>Check that <code>sources/terrarium-waiheke.pmtiles</code> exists</li>
<li>Verify the terrain source is correctly defined in <code>style.json</code></li>
<li>Check browser console (F12) for errors</li>
<li>Make sure the terrain source uses <code>pmtiles://</code> protocol</li>
</ul>
<h3>Commit Your Changes</h3>
<p>Add, commit, and push your revised <code>index.html</code> and <code>style.json</code> to your remote fork.</p>
<p>Verify that the map you see via your local server and the one you see via Github Pages match the image below.</p>
<h3>What You Have Now</h3>
<p>At the end of this step, you should have:</p>
<ul>
<li><code>sources/terrarium-waiheke.pmtiles</code> - Terrain elevation data</li>
<li>Hillshade layer displaying terrain shading</li>
</ul>
<p>Your map now shows the beautiful topography of Waiheke Island! üèîÔ∏è</p>
<h3>Want to take this further?</h3>
<p>These style edits are just the beginning. If you want to keep polishing, here are some challenges:</p>
<ol>
<li><strong>Add some transparency to the landcover</strong> so that you can see the terrain through it</li>
<li><strong>Refine the Te Ara Hura styling</strong> by changing the color, or changing the line width across zooms</li>
<li><strong>Refine the terrain styling</strong> by modifying the color values for shadows and highlights, changing the exaggeration</li>
</ol>

        
          <div class="map-preview-container">
  <h2>Your Map Preview</h2>
  <div class="map-preview-wrapper">
    <img src="../images/step-07.png" alt="Map preview showing expected result at this stage" class="map-preview-image" style="max-width: 100%; height: auto; border: 1px solid #dee2e6; border-radius: 4px;">
    
      <p class="map-note">This is what your map should look like when you view it locally and via your Github Pages website</p>
    
  </div>
</div>


        
        
        <hr>
<p><strong><a href="../step-06/">‚Üê Previous: Step 6</a> | <a href="../step-08/">Next: Step 8 - Add Interactivity ‚Üí</a></strong></p>
      </article>
    </main>
  </div>

  <footer class="workshop-footer">
    <p>FOSS4G 2025 Workshop - <a rel="noreferrer" target="_blank" href="https://talks.osgeo.org/foss4g-2025/speaker/7A883D/">Stephanie May</a></p>
    <p class="footer-attribution">
      Background image: <a rel="noreferrer" target="_blank" href="https://www.flickr.com/photos/4nitsirk/5624277298" title="The sun returns to Waiheke Island">The sun returns to Waiheke Island</a> by <a rel="noreferrer" target="_blank" href="https://www.flickr.com/photos/4nitsirk/">Kristina D.C. Hoeppner</a>, <a target="_blank" href="https://creativecommons.org/licenses/by-sa/2.0/deed.en" rel="noreferrer">CC BY-SA 2.0</a>
    </p>
  </footer>

  <script>
    // Toggle sidebar on mobile
    const sidebarToggle = document.getElementById('sidebarToggle');
    const sidebarContent = document.getElementById('sidebarContent');
    
    if (sidebarToggle && sidebarContent) {
      sidebarToggle.addEventListener('click', function() {
        const sidebar = sidebarContent.closest('.workshop-sidebar');
        if (sidebar) {
          sidebar.classList.toggle('open');
        }
        sidebarContent.classList.toggle('open');
        sidebarToggle.classList.toggle('active');
      });
      
      // Close sidebar when clicking outside on mobile
      document.addEventListener('click', function(event) {
        if (window.innerWidth <= 768) {
          if (!sidebarContent.contains(event.target) && !sidebarToggle.contains(event.target)) {
            sidebarContent.classList.remove('open');
            sidebarToggle.classList.remove('active');
          }
        }
      });
    }
  </script>
</body>
</html>

